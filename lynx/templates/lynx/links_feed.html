{% extends 'lynx/base.html' %}

{% block title %}{{ title }} | Lynx{% endblock %}

{% block head_css %}
<style>
  .article-flex {
    display: flex;
    flex-wrap: nowrap;
    justify-content: flex-start;
    padding-top: 1rem;
  }
  .article-flex > div:nth-child(2) {
    /* subtract the image and padding */
    width: calc(100% - 6rem);
  }
  img.preview-img {
    width: 5rem;
    height: 5rem;
    max-width: unset;
    margin-right: 1rem;
    object-fit: cover;
  }
  /* Want list view to be more dense than default styles */
  article {
    padding: 0 1rem;
    margin: 1rem auto;
  }
  .truncate {
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
  }
</style>
{% endblock %}

{% block nav_title %}{{ title }}{% endblock %}

{% block content %}
  <details {% if selected_filter != 'all' %}open{% endif %}>
    <summary>Search & Filters</summary>
    <div class="grid">
      <div role="group">
        <a href="{% url 'lynx:links_feed_read' %}" role="button" class="secondary {% if selected_filter != 'read'%}outline{% endif %}">Read</a>
        <a href="{% url 'lynx:links_feed_unread' %}" role="button" class="secondary {% if selected_filter != 'unread'%}outline{% endif %}">Unread</a>
        <a href="{% url 'lynx:links_feed_all' %}" role="button" class="secondary {% if selected_filter != 'all'%}outline{% endif %}">All</a>
      </div>
      <div>
        <form role="search" action="{% url 'lynx:links_feed_search' %}" method="get">
          <input type="text" name="q" placeholder="Search" value="{{ query }}" autocomplete="off"/>
          <button type="submit">Search</button>
        </form>
      </div>
    </div>
  </details>
  {% if links_list %}
  {% for link in links_list %}
  <article>
    <div class="article-flex">
      <img class="preview-img" src="{{ link.header_image_url }}" alt="{{ link.title }}" />
      <div>
        <hgroup>
          <h4><a href="{% url 'lynx:link_viewer' link.id %}">{{ link.title }}</a></h4>
          <h5>{{ link.article_date }} Â· {{ link.hostname }}</h5>
        </hgroup>
        <p class="truncate">
          {{ link.excerpt }}
        </p>
      </div>
    </div>
  </article>
  {% endfor %}
  {% else %}
  <p>No links are saved</p>
  {% endif %}
{% endblock %}
